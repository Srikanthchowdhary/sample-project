---
actions:
  1:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-app01.cwds.io-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value: {{ hostvars[groups['elk'][0]]['index_prefix']}}-app01.cwds.io-log-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  2:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-dev.cwds.io-docker-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value: {{ hostvars[groups['elk'][0]]['index_prefix']}}-dev.cwds.io-docker-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  3:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-dev.cwds.io-log-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-dev.cwds.io-log-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  4:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-integration.cwds.io-docker-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-integration.cwds.io-docker-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  5:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-integration.cwds.io-log-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-integration.cwds.io-log-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  6:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-preint.cwds.io-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-preint.cwds.io-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  7:
    action: delete_indices
    description: >-
      Delete indices older than 90 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-jsonparsefailure-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-jsonparsefailure-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  11:
    action: delete_indices
    description: >-
      Delete indices older than 90 days (based on index name), for .watcher-history-3-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  .watcher-history-3-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 3
      exclude:

  12:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-demo-int.cwds.io-log-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-demo-int.cwds.io-log-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  15:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-micro.cwds.io-docker-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-micro.cwds.io-docker-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  16:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-micro.cwds.io-log-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-micro.cwds.io-log-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  17:
    action: delete_indices
    description: >-
      Delete indices older than 14 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-rundeck
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-rundeck
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 13
      exclude:

  18:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-%
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-%
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  19:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-_
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  {{ hostvars[groups['elk'][0]]['index_prefix']}}-_
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 7
      exclude:

  150:
    action: delete_indices
    description: >-
      Delete all non-prod-* indexes oldes then 150 days
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value:  non-prod-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 150
      exclude:

  160:
    action: close
    description: >-
      Close access indices older than 90 days (based on index name), for access-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value: access-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 90
      exclude:

  161:
    action: close
    description: >-
      Close indices older than 90 days (based on index name), for {{ hostvars[groups['elk'][0]]['index_prefix']}}-_
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value: {{ hostvars[groups['elk'][0]]['index_prefix']}}-_
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 90
      exclude:

  163:
    action: close
    description: >-
      Close indices older than 90 days (based on index name), for archive-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: pattern
      kind: prefix
      value: archive-
      exclude:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 90
      exclude:


  170:
    action: shrink
    description: >-
      Shrink  indices older than 14 days (based on index name), for access-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
      shrink_node: DETERMINISTIC
      node_filters:
        permit_masters: True
        exclude_nodes: ['not_this_node']
      number_of_shards: 1
      number_of_replicas: 0
      shrink_prefix: 'archive-'
      shrink_suffix: ''
      delete_after: True
      post_allocation:
        allocation_type: include
        key: node_tag
        value: cold
      wait_for_active_shards: 1
      extra_settings:
        settings:
          index.codec: best_compression
      wait_for_completion: True
      wait_for_rebalance: True
      wait_interval: 9
      max_wait: -1
    filters:
    - filtertype: pattern
      kind: prefix
      value: {{ hostvars[groups['elk'][0]]['index_prefix']}}-
      exclude:
    - filtertype: pattern
      kind: suffix
      value: -shrink
      exclude: True
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 14
      exclude:



  171:
    action: shrink
    description: >-
      Shrink  indices older than 14 days (based on index name), for access-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
      shrink_node: DETERMINISTIC
      node_filters:
        permit_masters: True
        exclude_nodes: ['not_this_node']
      number_of_shards: 1
      number_of_replicas: 0
      shrink_prefix: 'archive-'
      shrink_suffix: ''
      delete_after: True
      post_allocation:
        allocation_type: include
        key: node_tag
        value: cold
      wait_for_active_shards: 1
      extra_settings:
        settings:
          index.codec: best_compression
      wait_for_completion: True
      wait_for_rebalance: True
      wait_interval: 9
      max_wait: -1
    filters:
    - filtertype: pattern
      kind: prefix
      value: access-
      exclude:
    - filtertype: pattern
      kind: suffix
      value: -shrink
      exclude: True
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 14
      exclude:


  500:
    action: delete_indices
    description: >-
      Delete all indexes oldes then 1098 days
    options:
      ignore_empty_list: True
      timeout_override:
      continue_if_exception: False
      disable_action: False
    filters:
    - filtertype: age
      source: name
      direction: older
      timestring: '%Y.%m.%d'
      unit: days
      unit_count: 1098
